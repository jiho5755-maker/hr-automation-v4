# 👶 출산·육아기 행정 업무 자동화 툴

**2026년 개정 노동법 기준 | Python Streamlit 기반**

사장님이 쉽게 사용할 수 있도록 설계된 출산·육아기 행정 업무 자동화 웹 애플리케이션입니다.

---

## ✨ 주요 기능

### 📋 기능 A: 재택근무 증빙 로그 생성기 (Smart Work Log)
- **자동 날짜 필터링**: 평일만 자동 선택 (주말 및 2026년 공휴일 제외)
- **시간 랜덤화**:
  - 시작: 11:00 기준 ±5분 (예: 10:56, 11:02)
  - 종료: 18:00 기준 +0~10분 (예: 18:01, 18:09)
- **업무 자동 배정**: 디자인 기획 직무 업무 15개 중 랜덤 선택
- **엑셀 다운로드**: 증빙용 로그를 `.xlsx` 파일로 즉시 다운로드

### 📄 기능 B: PDF 서식 자동 생성 ✨ NEW!
1. **임신기 근로시간 단축 신청서**
   - 원본 서식과 동일한 레이아웃으로 PDF 생성
   - 근로자 정보, 출산예정일, 단축기간 자동 입력
   - 서명란 포함 (인쇄 후 직접 서명 가능)
   
2. **임신사유 근로시간 단축 확인서** (별지 제22호의2)
   - 고용노동청 제출용 공식 서식
   - 월별 단축근무 사용 기간 자동 계산
   - 근로자 및 사업주 서명란 포함
   - 위라밸일자리 장려금 신청용

### 💰 기능 C: 2026 개정법 기준 지원금 시뮬레이터
1. **대체인력 지원금** (30인 미만 기업 특례)
   - 월 140만원 기준
   - 인수인계 기간 + 출산휴가 + 육아휴직 합산
   
2. **육아기 근로시간 단축 장려금**
   - 임신 중 2시간 단축 시 월 40만원
   - 실제 근무일 기준 자동 계산

3. **업무분담 지원금**
   - 월 최대 60만원, 최대 6개월 지원
   - 동료 직원 업무 분담 보상

### 📊 기능 D: 정부 서식 데이터 맵핑
- **별지 제22호의2 서식**: 임신사유 근로시간 단축 확인서
- **별지 제7호의2 서식**: 출산전후휴가·육아휴직 통합 신청서
- 자동 데이터 매핑 및 요약 테이블 제공

---

## 🚀 빠른 시작

### 1. 설치

```bash
# 프로젝트 디렉토리로 이동
cd "인사팀 자동화"

# 필요한 패키지 설치
pip install -r requirements.txt
```

### 2. 실행

```bash
streamlit run app.py
```

브라우저가 자동으로 열리면서 애플리케이션이 시작됩니다!

### 3. 사용

1. **탭 1 (데이터 확인)**: 근로자, 사업주, 일정 정보 확인
2. **탭 2 (엑셀 생성)**: 재택근무 로그 및 정부 서식 다운로드
3. **탭 3 (PDF 서식 생성)**: ✨ 임신 관련 서식 PDF 자동 생성
4. **탭 4 (지원금 리포트)**: 예상 지원금 자동 계산 및 리포트

---

## 📁 프로젝트 구조

```
인사팀 자동화/
│
├── app.py              # Streamlit 메인 애플리케이션 (UI)
├── engine.py           # 핵심 계산 엔진 (로그 생성, 지원금 계산)
├── constants.py        # 마스터 데이터 및 상수 정의
├── pdf_generator.py    # PDF 서식 자동 생성 모듈 ✨ NEW!
│
├── requirements.txt    # Python 패키지 의존성
└── README.md          # 이 파일
```

---

## 🎯 마스터 데이터

### 근로자 정보
- **이름**: 송미
- **주민등록번호**: 910828-2xxxxxx
- **부서/직급**: 디자인 기획팀 대리

### 사업주 정보
- **대표자**: 이진선
- **회사 규모**: 30인 미만 (지원금 특례 적용)

### 주요 일정
| 구분 | 기간 | 비고 |
|------|------|------|
| 임신 단축근무 | 2026-01-21 ~ 2026-02-27 | 11:00~18:00 근무 (6시간) |
| 출산 예정일 | 2026-03-18 | - |
| 출산 휴가 | 2026-03-01 ~ 2026-05-29 | 90일 법정 휴가 |
| 육아 휴직 | 2026-05-30 ~ 2027-05-29 | 1년 풀 사용 |
| 대체인력 채용 | 2026-01-01 | 인수인계 기간 포함 |

---

## 💡 핵심 알고리즘

### 1. 재택근무 로그 생성 (SmartWorkLogGenerator)

```python
# 평일 필터링 (주말 및 공휴일 제외)
SmartWorkLogGenerator.is_workday(date)

# 랜덤 시간 생성
start_time = generate_random_time("11:00", -5, 5)  # 10:55~11:05
end_time = generate_random_time("18:00", 0, 10)    # 18:00~18:10

# 업무 랜덤 배정
task = random.choice(DESIGN_TASKS)  # 15개 업무 중 선택
```

### 2. 지원금 계산 (SubsidyCalculator)

```python
# 대체인력 지원금 = 인수인계 + 출산휴가 + 육아휴직
# 근로시간 단축 장려금 = 월 40만원 × 근무일/22일
# 업무분담 지원금 = 월 60만원 × 최대 6개월

total = SubsidyCalculator.calculate_all_subsidies()
# → {'총합계': 20,800,000원, ...}
```

### 3. 정부 서식 매핑 (GovernmentFormMapper)

```python
# 별지 제22호의2 서식
form_22_2 = GovernmentFormMapper.map_form_22_2(employee, employer)
# → 근로자 정보, 임신 정보, 단축근무 정보 자동 매핑

# 별지 제7호의2 서식
form_7_2 = GovernmentFormMapper.map_form_7_2(employee, employer)
# → 출산휴가, 육아휴직, 대체인력 정보 자동 매핑
```

---

## 🔧 데이터 수정 방법

### 근로자/사업주 정보 변경

`constants.py` 파일을 열어서 다음 부분을 수정하세요:

```python
EMPLOYEE_INFO = {
    "이름": "송미",           # ← 이름 수정
    "주민등록번호": "910828-2xxxxxx",  # ← 주민번호 수정
    "부서": "디자인 기획팀",   # ← 부서 수정
    "직급": "대리",           # ← 직급 수정
}

EMPLOYER_INFO = {
    "대표자명": "이진선",      # ← 대표자명 수정
    "회사명": "(주)예시회사",  # ← 회사명 수정
    ...
}
```

### 일정 변경

```python
PREGNANCY_SHORT_WORK = {
    "시작일": date(2026, 1, 21),  # ← 날짜 수정
    "종료일": date(2026, 2, 27),  # ← 날짜 수정
    ...
}

CHILDBIRTH_INFO = {
    "출산예정일": date(2026, 3, 18),  # ← 출산예정일 수정
    ...
}
```

### 업무 리스트 변경 (디자인 기획 → 다른 직무)

```python
DESIGN_TASKS = [
    "브랜드 리뉴얼 UI/UX 시안 검토",  # ← 직무에 맞게 수정
    "신규 제품 패키지 디자인 컨셉 기획",
    # ... 15개 업무 리스트
]
```

수정 후 저장하고 앱을 재실행하면 자동으로 반영됩니다!

---

## 📊 출력 파일

### 1. 재택근무 로그 (Excel)
- **파일명**: `재택근무로그_송미_YYYYMMDD.xlsx`
- **시트**: 재택근무로그
- **컬럼**: 날짜, 요일, 근무 시작, 근무 종료, 휴게시간, 실근로시간, 업무 내용, 비고

### 2. 전체 데이터 (Excel)
- **파일명**: `출산육아_전체데이터_송미_YYYYMMDD.xlsx`
- **시트**:
  - 재택근무로그
  - 별지22-2요약 (임신 단축 확인서)
  - 별지7-2요약 (출산육아 통합 신청서)
  - 일정요약

### 3. PDF 서식 ✨ NEW!
- **파일명 1**: `임신기_근로시간_단축_신청서_송미_YYYYMMDD.pdf`
  - 회사 내부 제출용 신청서
  - 원본 서식과 동일한 레이아웃
  - 인쇄 후 서명 가능
  
- **파일명 2**: `임신사유_근로시간_단축_확인서_송미_YYYYMMDD.pdf`
  - 고용노동청 제출용 공식 서식 (별지 제22호의2)
  - 위라밸일자리 장려금 신청용
  - 근로자 및 사업주 서명란 포함

### 4. 지원금 리포트 (Excel)
- **파일명**: `지원금리포트_송미_YYYYMMDD.xlsx`
- **시트**: 지원금요약
- **내용**: 대체인력, 단축장려금, 업무분담 지원금 상세

---

## 🎯 2026년 개정 노동법 특징

### 주요 변경사항
1. **30인 미만 기업 특례**: 대체인력 지원금 월 140만원으로 상향
2. **인수인계 기간 지원**: 대체인력 채용 후 인수인계 기간도 지원금 지급
3. **근로시간 단축 장려금 강화**: 2시간 이상 단축 시 월 40만원
4. **업무분담 지원금 신설**: 동료 직원 업무 분담 시 월 최대 60만원

### 적용 대상
- 30인 미만 중소기업
- 임신 중 근로자 (근로시간 단축)
- 출산휴가 및 육아휴직 사용 근로자
- 대체인력을 채용한 사업주

---

## ⚠️ 주의사항

1. **지원금은 시뮬레이션입니다**: 실제 지원금은 고용노동부 심사에 따라 달라질 수 있습니다.
2. **신청은 별도**: 본 툴은 서류 준비용이며, 실제 신청은 고용센터를 통해 진행하세요.
3. **데이터 확인**: `constants.py`의 데이터가 정확한지 반드시 확인하세요.
4. **공휴일 업데이트**: 2027년 이후 사용 시 `HOLIDAYS_2026` 리스트를 업데이트하세요.

---

## 🔍 문제 해결

### Q1. `ModuleNotFoundError: No module named 'streamlit'`
```bash
pip install -r requirements.txt
```

### Q2. 엑셀 다운로드가 안돼요
- 브라우저 팝업 차단을 해제하세요
- 다운로드 폴더 권한을 확인하세요

### Q3. 날짜가 이상하게 나와요
- `constants.py`의 날짜 형식을 확인하세요: `date(2026, 1, 21)`
- Python datetime 모듈 형식을 사용해야 합니다

### Q4. 공휴일이 근무일로 나와요
- `HOLIDAYS_2026` 리스트에 해당 날짜를 추가하세요

### Q5. PDF 생성이 안돼요
```bash
# ReportLab 설치
pip install reportlab
```
- macOS: 시스템 폰트(AppleGothic) 자동 사용
- Windows: 맑은 고딕(malgun.ttf) 자동 사용
- 폰트 관련 에러 시: 시스템 기본 폰트로 대체됩니다

---

## 📞 기술 지원

### 개발 환경
- Python 3.8 이상
- Streamlit 1.32.0
- Pandas 2.2.0
- Openpyxl 3.1.2
- ReportLab 4.0.9 ✨ (PDF 생성)

### 권장 사양
- 메모리: 최소 2GB
- 브라우저: Chrome, Edge, Safari 최신 버전

---

## 📝 라이선스

이 프로젝트는 중소기업의 출산·육아 행정 업무 효율화를 위해 만들어졌습니다.  
자유롭게 사용하시고, 개선 아이디어가 있다면 공유해주세요!

---

## 🙏 감사합니다

- 고용노동부의 출산·육아 지원 정책
- 대한민국의 모든 워킹맘/워킹대디
- 직원을 배려하는 모든 사장님들

---

**👶 출산·육아기 행정 업무 자동화 툴**  
*Made with ❤️ for small business owners and HR teams*
