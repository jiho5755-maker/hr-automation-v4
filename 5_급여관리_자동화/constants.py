"""
급여관리 자동화 - 상수 정의
2026년 기준 세율 및 보험료율
"""

from datetime import datetime

# ============================================================
# 앱 설정
# ============================================================

APP_CONFIG = {
    "제목": "💰 급여관리 자동화",
    "아이콘": "💰",
    "레이아웃": "wide",
    "버전": "1.0.0",
    "설명": "4대보험, 소득세 자동 계산 및 급여명세서 생성"
}

# ============================================================
# 2026년 최저임금 (고용노동부 공시 기준)
# ============================================================

MINIMUM_WAGE = {
    "시급": 10320,  # 2026년 최저시급 (정확한 공식 기준)
    "월급": 2156880,  # 주 40시간 기준 (209시간 × 10,320원)
    "일급": 82560,  # 8시간 기준
    "적용일": "2026-01-01",
    "비고": "주 40시간(월 209시간) 근무 기준"
}

# ============================================================
# 4대보험 요율 (2026년 기준)
# ============================================================

INSURANCE_RATES = {
    "국민연금": {
        "요율": 0.095,  # 9.5% (근로자+사업주 각 4.75%)
        "사업주부담": 0.0475,  # 4.75%
        "근로자부담": 0.0475,  # 4.75%
        "최저기준": 390000,  # 2026년 최저기준소득
        "최고기준": 6170000,  # 2026년 최고기준소득
        "적용일": "2026-07-01",
        "비고": "상·하한 금액은 연 1회 7월에 조정"
    },
    "건강보험": {
        "요율": 0.072,  # 7.20% (2026년 공식)
        "사업주부담": 0.036,  # 3.60%
        "근로자부담": 0.036,  # 3.60%
        "장기요양": 0.1314,  # 건강보험료의 13.14% (2026년 공식)
        "적용일": "2026-01-01",
        "비고": "장기요양보험료는 건강보험료에 요율을 곱하여 산정"
    },
    "고용보험": {
        "요율": 0.018,  # 1.8% (실업급여)
        "사업주부담": 0.009,  # 0.9%
        "근로자부담": 0.009,  # 0.9%
        "실업급여": {
            "사업주": 0.009,  # 0.9%
            "근로자": 0.009   # 0.9%
        },
        "고용안정": {
            "150인미만": 0.0025,  # 0.25%
            "150인이상_1000인미만": 0.0045,  # 0.45%
            "1000인이상_우선지원": 0.0065,  # 0.65%
            "1000인이상": 0.0085   # 0.85%
        },
        "적용일": "2026-01-01",
        "비고": "실업급여 + 고용안정·직업능력개발사업(사업주만 부담)"
    },
    "산재보험": {
        "기본요율": 0.007,  # 0.7% (업종별 상이)
        "사업주부담": 1.0,   # 100% 사업주 부담
        "근로자부담": 0.0,   # 0%
        "적용일": "2026-01-01",
        "비고": "업종별로 요율이 다르며, 전액 사업주 부담"
    }
}

# ============================================================
# 소득세율 (2026년 기준 간이세액표)
# ============================================================

INCOME_TAX_BRACKETS = [
    {"max": 14000000, "rate": 0.06, "deduction": 0},
    {"max": 50000000, "rate": 0.15, "deduction": 1260000},
    {"max": 88000000, "rate": 0.24, "deduction": 5760000},
    {"max": 150000000, "rate": 0.35, "deduction": 15440000},
    {"max": 300000000, "rate": 0.38, "deduction": 19940000},
    {"max": 500000000, "rate": 0.40, "deduction": 25940000},
    {"max": 1000000000, "rate": 0.42, "deduction": 35940000},
    {"max": float('inf'), "rate": 0.45, "deduction": 65940000}
]

# 근로소득공제
EARNED_INCOME_DEDUCTION_BRACKETS = [
    {"max": 5000000, "rate": 0.70, "fixed": 0},
    {"max": 15000000, "rate": 0.40, "fixed": 3500000},
    {"max": 45000000, "rate": 0.15, "fixed": 7500000},
    {"max": 100000000, "rate": 0.05, "fixed": 12000000},
    {"max": float('inf'), "rate": 0.02, "fixed": 14750000, "max_deduction": 20000000}
]

# 인적공제
PERSONAL_DEDUCTION = {
    "본인": 1500000,
    "배우자": 1500000,
    "부양가족": 1500000,  # 1인당
    "경로우대": 1000000,  # 70세 이상 추가
    "장애인": 2000000,   # 추가
    "부녀자": 500000,
    "한부모": 1000000
}

# 지방소득세 (소득세의 10%)
LOCAL_TAX_RATE = 0.10

# ============================================================
# 급여 항목
# ============================================================

SALARY_ITEMS = {
    "기본급": ["기본급", "직급수당", "직책수당"],
    "수당": [
        "식대", "교통비", "자격수당", "가족수당",
        "시간외수당", "야간수당", "휴일수당",
        "연차수당", "성과급", "상여금"
    ],
    "공제": [
        "국민연금", "건강보험", "장기요양보험", 
        "고용보험", "소득세", "지방소득세"
    ]
}

# 비과세 한도
TAX_FREE_LIMITS = {
    "식대": 200000,      # 월 20만원
    "자가운전보조금": 200000,  # 월 20만원
    "육아수당": 200000,   # 월 20만원
    "출산수당": 200000,   # 월 20만원
}

# ============================================================
# 근무 시간
# ============================================================

WORK_TIME = {
    "법정근로시간": {
        "일": 8,
        "주": 40,
        "월": 209,  # 주 40시간 기준 월 환산 (365일/7일×40시간/12개월)
        "주최대": 52,  # 법정 40시간 + 연장 12시간 = 최대 52시간
        "비고": "근로기준법 제50조, 제53조"
    },
    "연장근로": {
        "주최대": 12,  # 주 12시간까지 (근로기준법 제53조)
        "가산율": 1.5,  # 50% 가산 (근로기준법 제56조)
        "계산방식": "통상시급 × 근로시간 × 1.5",
        "비고": "주 52시간을 초과할 수 없음"
    },
    "야간근로": {
        "시작": 22,  # 22시~06시
        "종료": 6,
        "가산율": 1.5,  # 50% 가산 (근로기준법 제56조)
        "계산방식": "통상시급 × 근로시간 × 1.5",
        "비고": "야간근로(22:00~06:00) 시 가산수당 지급"
    },
    "휴일근로": {
        "가산율": 1.5,  # 8시간 이하 50% 가산
        "초과가산율": 2.0,  # 8시간 초과 100% 가산 (근로기준법 제56조)
        "계산방식_8시간이하": "통상시급 × 근로시간 × 1.5",
        "계산방식_8시간초과": "통상시급 × 근로시간 × 2.0",
        "비고": "휴일근로 8시간 초과 시 100% 가산"
    }
}

# ============================================================
# 연차/퇴직
# ============================================================

LEAVE_POLICY = {
    "연차발생": {
        "1년미만": 1,  # 월 1개
        "1년이상": 15,  # 년 15개
        "3년이상": 16,  # 3년부터 매 2년마다 1개 추가
        "최대": 25      # 최대 25개
    },
    "연차수당": {
        "미사용연차": True,  # 미사용 연차 수당 지급
        "계산방식": "통상임금"
    }
}

RETIREMENT_PAY = {
    "지급조건": {
        "최소근속": 1,  # 1년 이상 근속
        "주평균근로": 15  # 주 15시간 이상
    },
    "계산방식": {
        "기준": "평균임금",  # 평균임금 기준
        "일수": 30,  # 30일분
        "기간": 1  # 1년 기준
    }
}

# ============================================================
# 기타
# ============================================================

# 통상임금: 정기적, 일률적, 고정적으로 지급되는 임금
REGULAR_WAGE_ITEMS = ["기본급", "직급수당", "직책수당", "가족수당"]

# 평균임금: 산정 사유 발생일 이전 3개월간 지급된 임금 총액 / 그 기간의 총일수
AVERAGE_WAGE_PERIOD = 3  # 개월

# 급여 지급일
DEFAULT_PAYDAY = 21  # 매월 21일

# 급여명세서 필수 기재사항
PAYSLIP_REQUIRED_ITEMS = [
    "성명", "생년월일", "사원번호",
    "부서", "직급", "입사일",
    "귀속년월", "지급일",
    "기본급", "각종 수당",
    "공제 내역", "실수령액"
]

# ============================================================
# 엑셀 출력 설정
# ============================================================

EXCEL_CONFIG = {
    "급여대장": {
        "컬럼": [
            "사번", "성명", "부서", "직급",
            "기본급", "수당합계", "총지급액",
            "국민연금", "건강보험", "고용보험", "소득세", "지방세",
            "공제합계", "실수령액"
        ],
        "시트명": "급여대장"
    },
    "급여명세서": {
        "시트명": "급여명세서"
    }
}

# ============================================================
# 유틸리티 함수
# ============================================================

def get_current_year_month():
    """현재 년월 반환 (YYYY-MM 형식)"""
    now = datetime.now()
    return now.strftime("%Y-%m")

def format_currency(amount):
    """금액 포맷팅"""
    if amount is None:
        return "₩0"
    return f"₩{amount:,.0f}"

def get_tax_rate(annual_income):
    """연간 소득에 대한 세율 반환"""
    for bracket in INCOME_TAX_BRACKETS:
        if annual_income <= bracket["max"]:
            return bracket["rate"], bracket["deduction"]
    return INCOME_TAX_BRACKETS[-1]["rate"], INCOME_TAX_BRACKETS[-1]["deduction"]
